#!/usr/bin/env python3
"""Check audio devices and permissions"""

print("üîç Checking Audio Devices")
print("=" * 60)

# Check PyAudio devices
print("\n1. PyAudio Devices:")
try:
    import pyaudio
    p = pyaudio.PyAudio()

    input_devices = []
    for i in range(p.get_device_count()):
        info = p.get_device_info_by_index(i)
        if info['maxInputChannels'] > 0:
            input_devices.append(info)
            print(f"   ‚úÖ Input Device {i}: {info['name']}")

    if not input_devices:
        print("   ‚ùå No input devices found!")
    else:
        print(f"\n   Total: {len(input_devices)} input device(s)")

    p.terminate()
except Exception as e:
    print(f"   ‚ùå Error checking PyAudio: {e}")

# Check Ollama
print("\n2. Ollama Status:")
try:
    import ollama
    models = ollama.list()
    print(f"   ‚úÖ Ollama running")
    print(f"   Models available:")
    for model in models.models:
        print(f"      - {model.model}")
except Exception as e:
    print(f"   ‚ùå Ollama not running: {e}")
    print("   Start with: ollama serve")

# Check FastRTC
print("\n3. FastRTC:")
try:
    import fastrtc
    print("   ‚úÖ FastRTC installed")
except Exception as e:
    print(f"   ‚ùå FastRTC error: {e}")

print("\n" + "=" * 60)
print("üí° RECOMMENDATIONS:")
print("=" * 60)

print("""
For BROWSER MODE issues:
1. Check System Settings ‚Üí Privacy ‚Üí Microphone ‚Üí Enable browser
2. Restart browser after granting permissions
3. Try different browser (Chrome, Safari, Firefox)
4. Check browser console for detailed errors

For CONSOLE MODE:
1. Grant Terminal microphone access in System Settings
2. Run: ./run_console.sh
3. This mode is more reliable on macOS

Current status: Console mode should work!
""")